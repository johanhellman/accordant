# Pre-commit hooks configuration (optional, non-blocking)
# 
# INSTALLATION (optional):
#   make install-pre-commit
#   OR: uv run pre-commit install
#
# USAGE:
#   - Hooks run automatically on git commit
#   - To skip hooks: git commit --no-verify
#   - To run manually: make run-pre-commit
#   - To skip specific hooks: SKIP=ruff,prettier git commit
#
# NOTE: These hooks are OPTIONAL and NON-BLOCKING.
# You can always skip them with --no-verify if needed.

repos:
  - repo: local
    hooks:
      # Backend hooks (using uv)
      - id: ruff-format
        name: ruff format
        entry: uv run ruff format
        language: system
        types: [python]
        pass_filenames: true

      - id: ruff-lint
        name: ruff lint
        entry: uv run ruff check --fix
        language: system
        types: [python]
        pass_filenames: true

      - id: alembic-check
        name: alembic check
        entry: uv run alembic check
        language: system
        pass_filenames: false
        always_run: true

      # Frontend hooks (using npm)
      - id: prettier
        name: prettier format
        entry: bash -c 'cd frontend && npm run format'
        language: system
        files: ^frontend/
        pass_filenames: false # npm run format handles globbing internal to the script usually, or we can pass files if script supports it. 
        # But 'npm run format' in package.json is "prettier --write ..."
        # Let's just let it run on the whole frontend dir for safety or use pre-commit's file passing if we change the command.
        # Simpler: just use the npm command.

      - id: frontend-lint
        name: frontend lint
        entry: bash -c 'cd frontend && npm run lint:fix'
        language: system
        files: ^frontend/
        pass_filenames: false


